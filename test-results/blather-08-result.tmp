(TEST 8) Two Clients + Message Exchange
COMMENTS:
Two clients both log in and exchange several messages.


program: TESTY_MULTI

-----------------------------------------------------------------------------------------------
* Summary Program Information

| KEY      | COMMAND                  | RET | STATE      | OUTPUT-FILE                       | VALGRIND                     | 
| server   | ./bl_server gotham       |   0 | Done       | blather-08-server_output_file.tmp | blather-08-server_valgrd.tmp | 
| bruce    | ./bl_client gotham Bruce |   0 | Done       | blather-08-bruce_output_file.tmp  | blather-08-bruce_valgrd.tmp  | 
| clark    | ./bl_client gotham Clark |   0 | Done       | blather-08-clark_output_file.tmp  | blather-08-clark_valgrd.tmp  | 

1 FAILURES FOUND

-----------------------------------------------------------------------------------------------
* FAILURE 1
TEST OUTPUT MISMATCH: Side by Side Differences shown below 
- Expect output in: test-results/raw/blather-08-expect.tmp
- Acutal output in: test-results/raw/blather-08-actual.tmp
- Differing lines have a character like '|' and '<' in the middle

#+BEGIN_SRC diff
==== EXPECT ====                                           ==== ACTUAL ====                                        
>> START server ./bl_server gotham                         >> START server ./bl_server gotham
>> START bruce ./bl_client gotham Bruce                    >> START bruce ./bl_client gotham Bruce
>> START clark ./bl_client gotham Clark                    >> START clark ./bl_client gotham Clark
>> INPUT bruce Hey big guy!                                >> INPUT bruce Hey big guy!
>> INPUT bruce What's happening                            >> INPUT bruce What's happening
>> INPUT clark Not much, how about you?                    >> INPUT clark Not much, how about you?
>> INPUT bruce Hangin' out...                              >> INPUT bruce Hangin' out...
>> INPUT bruce In the BATCAVE                              >> INPUT bruce In the BATCAVE
>> INPUT clark I figured...                                >> INPUT clark I figured...
>> INPUT clark Gotta fly!                                  >> INPUT clark Gotta fly!
>> INPUT bruce Show off...                                 >> INPUT bruce Show off...
>> INPUT clark <EOF>                                       >> INPUT clark <EOF>
>> INPUT bruce <EOF>                                       >> INPUT bruce <EOF>
>> SIGNAL server -15                                       >> SIGNAL server -15
>> WAIT_ALL                                                >> WAIT_ALL
<testy> WAIT for server                                    <testy> WAIT for server
<testy> WAIT for bruce                                     <testy> WAIT for bruce
<testy> WAIT for clark                                     <testy> WAIT for clark
>> CHECK_ALL cat                                           >> CHECK_ALL cat
<testy> CHECK_FAILURES for server                          <testy> CHECK_FAILURES for server
<testy> CHECK_FAILURES for bruce                           <testy> CHECK_FAILURES for bruce
<testy> CHECK_FAILURES for clark                           <testy> CHECK_FAILURES for clark
>> OUTPUT_ALL ./test_filter_client_output                  >> OUTPUT_ALL ./test_filter_client_output

<testy> OUTPUT for server                                  <testy> OUTPUT for server
LOG: BEGIN: server_start()                                 LOG: BEGIN: server_start()
LOG: END: server_start()                                   LOG: END: server_start()
LOG: BEGIN: server_check_sources()                         LOG: BEGIN: server_check_sources()
LOG: poll()'ing to check 1 input sources                   LOG: poll()'ing to check 1 input sources
LOG: poll() completed with return value 1                  LOG: poll() completed with return value 1
LOG: join_ready = 1                                        LOG: join_ready = 1
LOG: END: server_check_sources()                           LOG: END: server_check_sources()
LOG: BEGIN: server_handle_join()                           LOG: BEGIN: server_handle_join()
LOG: join request for new client 'Bruce'                   LOG: join request for new client 'Bruce'
LOG: BEGIN: server_add_client()                            LOG: BEGIN: server_add_client()
LOG: END: server_add_client()                              LOG: END: server_add_client()
LOG: END: server_handle_join()                             LOG: END: server_handle_join()
LOG: BEGIN: server_check_sources()                         LOG: BEGIN: server_check_sources()
LOG: poll()'ing to check 2 input sources                   LOG: poll()'ing to check 2 input sources
LOG: poll() completed with return value 1                  LOG: poll() completed with return value 1
LOG: join_ready = 1                                        LOG: join_ready = 1
LOG: client 0 'Bruce' data_ready = 0                     <
LOG: END: server_check_sources()                           LOG: END: server_check_sources()
LOG: BEGIN: server_handle_join()                           LOG: BEGIN: server_handle_join()
LOG: join request for new client 'Clark'                   LOG: join request for new client 'Clark'
LOG: BEGIN: server_add_client()                            LOG: BEGIN: server_add_client()
LOG: END: server_add_client()                              LOG: END: server_add_client()
LOG: END: server_handle_join()                             LOG: END: server_handle_join()
LOG: BEGIN: server_check_sources()                         LOG: BEGIN: server_check_sources()
LOG: poll()'ing to check 3 input sources                   LOG: poll()'ing to check 3 input sources
LOG: poll() completed with return value 1                  LOG: poll() completed with return value 1
LOG: join_ready = 0                                      <
LOG: client 0 'Bruce' data_ready = 1                       LOG: client 0 'Bruce' data_ready = 1
LOG: client 1 'Clark' data_ready = 0                     <
LOG: END: server_check_sources()                           LOG: END: server_check_sources()
LOG: BEGIN: server_handle_client()                         LOG: BEGIN: server_handle_client()
LOG: client 0 'Bruce' MESSAGE 'Hey big guy!'               LOG: client 0 'Bruce' MESSAGE 'Hey big guy!'
LOG: END: server_handle_client()                           LOG: END: server_handle_client()
LOG: BEGIN: server_check_sources()                         LOG: BEGIN: server_check_sources()
LOG: poll()'ing to check 3 input sources                   LOG: poll()'ing to check 3 input sources
LOG: poll() completed with return value 1                  LOG: poll() completed with return value 1
LOG: join_ready = 0                                      <
LOG: client 0 'Bruce' data_ready = 1                       LOG: client 0 'Bruce' data_ready = 1
LOG: client 1 'Clark' data_ready = 0                     <
LOG: END: server_check_sources()                           LOG: END: server_check_sources()
LOG: BEGIN: server_handle_client()                         LOG: BEGIN: server_handle_client()
LOG: client 0 'Bruce' MESSAGE 'What's happening'           LOG: client 0 'Bruce' MESSAGE 'What's happening'
LOG: END: server_handle_client()                           LOG: END: server_handle_client()
LOG: BEGIN: server_check_sources()                         LOG: BEGIN: server_check_sources()
LOG: poll()'ing to check 3 input sources                   LOG: poll()'ing to check 3 input sources
LOG: poll() completed with return value 1                  LOG: poll() completed with return value 1
LOG: join_ready = 0                                      <
LOG: client 0 'Bruce' data_ready = 0                     <
LOG: client 1 'Clark' data_ready = 1                       LOG: client 1 'Clark' data_ready = 1
LOG: END: server_check_sources()                           LOG: END: server_check_sources()
LOG: BEGIN: server_handle_client()                         LOG: BEGIN: server_handle_client()
LOG: client 1 'Clark' MESSAGE 'Not much, how about you?'   LOG: client 1 'Clark' MESSAGE 'Not much, how about you?'
LOG: END: server_handle_client()                           LOG: END: server_handle_client()
LOG: BEGIN: server_check_sources()                         LOG: BEGIN: server_check_sources()
LOG: poll()'ing to check 3 input sources                   LOG: poll()'ing to check 3 input sources
LOG: poll() completed with return value 1                  LOG: poll() completed with return value 1
LOG: join_ready = 0                                      <
LOG: client 0 'Bruce' data_ready = 1                       LOG: client 0 'Bruce' data_ready = 1
LOG: client 1 'Clark' data_ready = 0                     <
LOG: END: server_check_sources()                           LOG: END: server_check_sources()
LOG: BEGIN: server_handle_client()                         LOG: BEGIN: server_handle_client()
LOG: client 0 'Bruce' MESSAGE 'Hangin' out...'             LOG: client 0 'Bruce' MESSAGE 'Hangin' out...'
LOG: END: server_handle_client()                           LOG: END: server_handle_client()
LOG: BEGIN: server_check_sources()                         LOG: BEGIN: server_check_sources()
LOG: poll()'ing to check 3 input sources                   LOG: poll()'ing to check 3 input sources
LOG: poll() completed with return value 1                  LOG: poll() completed with return value 1
LOG: join_ready = 0                                      <
LOG: client 0 'Bruce' data_ready = 1                       LOG: client 0 'Bruce' data_ready = 1
LOG: client 1 'Clark' data_ready = 0                     <
LOG: END: server_check_sources()                           LOG: END: server_check_sources()
LOG: BEGIN: server_handle_client()                         LOG: BEGIN: server_handle_client()
LOG: client 0 'Bruce' MESSAGE 'In the BATCAVE'             LOG: client 0 'Bruce' MESSAGE 'In the BATCAVE'
LOG: END: server_handle_client()                           LOG: END: server_handle_client()
LOG: BEGIN: server_check_sources()                         LOG: BEGIN: server_check_sources()
LOG: poll()'ing to check 3 input sources                   LOG: poll()'ing to check 3 input sources
LOG: poll() completed with return value 1                  LOG: poll() completed with return value 1
LOG: join_ready = 0                                      <
LOG: client 0 'Bruce' data_ready = 0                     <
LOG: client 1 'Clark' data_ready = 1                       LOG: client 1 'Clark' data_ready = 1
LOG: END: server_check_sources()                           LOG: END: server_check_sources()
LOG: BEGIN: server_handle_client()                         LOG: BEGIN: server_handle_client()
LOG: client 1 'Clark' MESSAGE 'I figured...'               LOG: client 1 'Clark' MESSAGE 'I figured...'
LOG: END: server_handle_client()                           LOG: END: server_handle_client()
LOG: BEGIN: server_check_sources()                         LOG: BEGIN: server_check_sources()
LOG: poll()'ing to check 3 input sources                   LOG: poll()'ing to check 3 input sources
LOG: poll() completed with return value 1                  LOG: poll() completed with return value 1
LOG: join_ready = 0                                      <
LOG: client 0 'Bruce' data_ready = 0                     <
LOG: client 1 'Clark' data_ready = 1                       LOG: client 1 'Clark' data_ready = 1
LOG: END: server_check_sources()                           LOG: END: server_check_sources()
LOG: BEGIN: server_handle_client()                         LOG: BEGIN: server_handle_client()
LOG: client 1 'Clark' MESSAGE 'Gotta fly!'                 LOG: client 1 'Clark' MESSAGE 'Gotta fly!'
LOG: END: server_handle_client()                           LOG: END: server_handle_client()
LOG: BEGIN: server_check_sources()                         LOG: BEGIN: server_check_sources()
LOG: poll()'ing to check 3 input sources                   LOG: poll()'ing to check 3 input sources
LOG: poll() completed with return value 1                  LOG: poll() completed with return value 1
LOG: join_ready = 0                                      <
LOG: client 0 'Bruce' data_ready = 1                       LOG: client 0 'Bruce' data_ready = 1
LOG: client 1 'Clark' data_ready = 0                     <
LOG: END: server_check_sources()                           LOG: END: server_check_sources()
LOG: BEGIN: server_handle_client()                         LOG: BEGIN: server_handle_client()
LOG: client 0 'Bruce' MESSAGE 'Show off...'                LOG: client 0 'Bruce' MESSAGE 'Show off...'
LOG: END: server_handle_client()                           LOG: END: server_handle_client()
LOG: BEGIN: server_check_sources()                         LOG: BEGIN: server_check_sources()
LOG: poll()'ing to check 3 input sources                   LOG: poll()'ing to check 3 input sources
LOG: poll() completed with return value 1                  LOG: poll() completed with return value 1
LOG: join_ready = 0                                      <
LOG: client 0 'Bruce' data_ready = 0                     <
LOG: client 1 'Clark' data_ready = 1                       LOG: client 1 'Clark' data_ready = 1
LOG: END: server_check_sources()                           LOG: END: server_check_sources()
LOG: BEGIN: server_handle_client()                         LOG: BEGIN: server_handle_client()
LOG: client 1 'Clark' DEPARTED                             LOG: client 1 'Clark' DEPARTED
LOG: END: server_handle_client()                           LOG: END: server_handle_client()
LOG: BEGIN: server_check_sources()                         LOG: BEGIN: server_check_sources()
LOG: poll()'ing to check 2 input sources                   LOG: poll()'ing to check 2 input sources
LOG: poll() completed with return value 1                  LOG: poll() completed with return value 1
LOG: join_ready = 0                                      <
LOG: client 0 'Bruce' data_ready = 1                       LOG: client 0 'Bruce' data_ready = 1
LOG: END: server_check_sources()                           LOG: END: server_check_sources()
LOG: BEGIN: server_handle_client()                         LOG: BEGIN: server_handle_client()
LOG: client 0 'Bruce' DEPARTED                             LOG: client 0 'Bruce' DEPARTED
LOG: END: server_handle_client()                           LOG: END: server_handle_client()
LOG: BEGIN: server_check_sources()                         LOG: BEGIN: server_check_sources()
LOG: poll()'ing to check 1 input sources                   LOG: poll()'ing to check 1 input sources
LOG: poll() completed with return value -1                 LOG: poll() completed with return value -1
LOG: poll() interrupted by a signal                        LOG: poll() interrupted by a signal
LOG: END: server_check_sources()                           LOG: END: server_check_sources()
LOG: BEGIN: server_shutdown()                              LOG: BEGIN: server_shutdown()
LOG: END: server_shutdown()                                LOG: END: server_shutdown()

<testy> OUTPUT for bruce                                   <testy> OUTPUT for bruce
-- Bruce JOINED --                                         -- Bruce JOINED --
-- Clark JOINED --                                         -- Clark JOINED --
[Bruce] : Hey big guy!                                   | [Bruce]: Hey big guy!
[Bruce] : What's happening                               | [Bruce]: What's happening
[Clark] : Not much, how about you?                       | [Clark]: Not much, how about you?
[Bruce] : Hangin' out...                                 | [Bruce]: Hangin' out...
[Bruce] : In the BATCAVE                                 | [Bruce]: In the BATCAVE
[Clark] : I figured...                                   | [Clark]: I figured...
[Clark] : Gotta fly!                                     | [Clark]: Gotta fly!
[Bruce] : Show off...                                    | [Bruce]: Show off...
-- Clark DEPARTED --                                       -- Clark DEPARTED --
End of Input, Departing                                    End of Input, Departing
                                                         > -- Bruce DEPARTED --
Bruce>>                                                    Bruce>> 

<testy> OUTPUT for clark                                   <testy> OUTPUT for clark
-- Clark JOINED --                                         -- Clark JOINED --
[Bruce] : Hey big guy!                                   | [Bruce]: Hey big guy!
[Bruce] : What's happening                               | [Bruce]: What's happening
[Clark] : Not much, how about you?                       | [Clark]: Not much, how about you?
[Bruce] : Hangin' out...                                 | [Bruce]: Hangin' out...
[Bruce] : In the BATCAVE                                 | [Bruce]: In the BATCAVE
[Clark] : I figured...                                   | [Clark]: I figured...
[Clark] : Gotta fly!                                     | [Clark]: Gotta fly!
[Bruce] : Show off...                                    | [Bruce]: Show off...
End of Input, Departing                                    End of Input, Departing
                                                         > -- Clark DEPARTED --
Clark>>                                                    Clark>> 

                                                         )
                                                         )
                                                         )
#+END_SRC

--- Line Differences ---
EXPECT:  42) LOG: client 0 'Bruce' data_ready = 0
EXPECT:  52) LOG: join_ready = 0
EXPECT:  54) LOG: client 1 'Clark' data_ready = 0
EXPECT:  62) LOG: join_ready = 0
EXPECT:  64) LOG: client 1 'Clark' data_ready = 0
EXPECT:  72) LOG: join_ready = 0
EXPECT:  73) LOG: client 0 'Bruce' data_ready = 0
EXPECT:  82) LOG: join_ready = 0
EXPECT:  84) LOG: client 1 'Clark' data_ready = 0
EXPECT:  92) LOG: join_ready = 0
EXPECT:  94) LOG: client 1 'Clark' data_ready = 0
EXPECT: 102) LOG: join_ready = 0
EXPECT: 103) LOG: client 0 'Bruce' data_ready = 0
EXPECT: 112) LOG: join_ready = 0
EXPECT: 113) LOG: client 0 'Bruce' data_ready = 0
EXPECT: 122) LOG: join_ready = 0
EXPECT: 124) LOG: client 1 'Clark' data_ready = 0
EXPECT: 132) LOG: join_ready = 0
EXPECT: 133) LOG: client 0 'Bruce' data_ready = 0
EXPECT: 142) LOG: join_ready = 0
EXPECT: 159) [Bruce] : Hey big guy!
EXPECT: 160) [Bruce] : What's happening
EXPECT: 161) [Clark] : Not much, how about you?
EXPECT: 162) [Bruce] : Hangin' out...
EXPECT: 163) [Bruce] : In the BATCAVE
EXPECT: 164) [Clark] : I figured...
EXPECT: 165) [Clark] : Gotta fly!
EXPECT: 166) [Bruce] : Show off...
ACTUAL: 139) [Bruce]: Hey big guy!
ACTUAL: 140) [Bruce]: What's happening
ACTUAL: 141) [Clark]: Not much, how about you?
ACTUAL: 142) [Bruce]: Hangin' out...
ACTUAL: 143) [Bruce]: In the BATCAVE
ACTUAL: 144) [Clark]: I figured...
ACTUAL: 145) [Clark]: Gotta fly!
ACTUAL: 146) [Bruce]: Show off...
ACTUAL: 149) -- Bruce DEPARTED --
EXPECT: 173) [Bruce] : Hey big guy!
EXPECT: 174) [Bruce] : What's happening
EXPECT: 175) [Clark] : Not much, how about you?
EXPECT: 176) [Bruce] : Hangin' out...
EXPECT: 177) [Bruce] : In the BATCAVE
EXPECT: 178) [Clark] : I figured...
EXPECT: 179) [Clark] : Gotta fly!
EXPECT: 180) [Bruce] : Show off...
ACTUAL: 154) [Bruce]: Hey big guy!
ACTUAL: 155) [Bruce]: What's happening
ACTUAL: 156) [Clark]: Not much, how about you?
ACTUAL: 157) [Bruce]: Hangin' out...
ACTUAL: 158) [Bruce]: In the BATCAVE
ACTUAL: 159) [Clark]: I figured...
ACTUAL: 160) [Clark]: Gotta fly!
ACTUAL: 161) [Bruce]: Show off...
ACTUAL: 163) -- Clark DEPARTED --


